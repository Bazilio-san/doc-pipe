/* eslint-disable no-console */
const fs = require('fs');
const path = require('path');

const patchArrayType = (relPath) => {
  const filePath = path.normalize(path.join(process.cwd(), relPath));
  let content = fs.readFileSync(filePath, 'utf-8');
  content = content.replace(/const (array|arr|refs|mapped) = \[];/g, `const $1: any = [];`);
  fs.writeFileSync(filePath, content);
};

console.log(`
Накладываю патч на ts файлы модуля 'openai'
`);

patchArrayType('node_modules/openai/src/internal/qs/utils.ts');
patchArrayType('node_modules/openai/src/_vendor/partial-json-parser/parser.ts');
